import pandas as pd
import numpy as np
import glob
import csv
import os
import tensorflow as tf
from collections import OrderedDict
from keras.preprocessing.sequence import pad_sequences

# 모델 로드
loaded_model = tf.keras.models.load_model('my model')

# 폴더 내의 모든 csv 파일을 가져옵니다.
test_folder_path = '/Users/soyeon/Downloads/csvFrom08/NIA_SL_WORD1259_REAL08_U_updated.csv'

# csv 파일을 읽어 시퀀스 리스트를 생성
test_sequences = []
data=pd.read_csv(test_folder_path)
test_sequences.append(data.values)

# 시퀀스를 numpy 배열로 변환
test_sequences = pad_sequences(test_sequences, dtype='float32', padding='post', maxlen=175)

# CPU, GPU 선택
with tf.device('/CPU:0'):

    # 모델 성능 평가
    loss, accuracy = loaded_model.evaluate(test_sequences)

    print("테스트 결과:")
    print(f"손실 값: {loss:.4f}")
    print(f"정확도: {accuracy:.4f}")

#my model에 저장된 학습망을 가져와서 테스트하는 코드입니다. 